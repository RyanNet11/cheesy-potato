import os,subprocess,requests,time,random,logging,sys,builtins;from datetime import datetime;X1="1938903914";X2=False;X3=False;X4={"A1":{"ip":"104.153.105.74:25200","B1":"","C1":"","D1":"","E1":".","F1":""},"A2":{"ip":"192.223.30.251:25200","B1":"","C1":"","D1":"","E1":"","F1":""},"A3":{"ip":"74.91.119.140:25200","B1":"","C1":"","D1":"","E1":"","F1":""}};X5="https://api.bflist.io/bf4/v1/servers/";X6="https://keeper.battlelog.com/snapshot/";X7="";X8="";X9=f"log_{datetime.now().strftime('%Y-%m-%d_%H-%M-%S')}.txt";logging.basicConfig(level=logging.INFO,format="%(asctime)s - %(message)s",datefmt="%Y-%m-%d %H:%M:%S",handlers=[logging.FileHandler(X9),logging.StreamHandler(sys.stdout)]);def X10(*X11,**X12):X13=" ".join(str(X14)for X14 in X11);logging.info(X13);builtins.print=X10;def X15():for X16,X17 in X4.items():X18=X5+X17["ip"];X19=requests.get(X18);X4[X16]["C1"]=X19.json();if X19.status_code!=200:print(f"Error: {X19.status_code}");print("-- API Data Received");for X16,X17 in X4.items():X17["E1"]=X17["C1"].get("numPlayers",0);X17["B1"]=X17["C1"].get("guid",0);print("-- API Data Processed");def X20():for X16,X17 in X4.items():X18=X6+X17["B1"];X19=requests.get(X18);X4[X16]["D1"]=X19.json();if X19.status_code!=200:print(f"Error: {X19.status_code}");print("-- Battlelog Data Received");for X16,X17 in X4.items():X17["F1"]=X17["D1"]["snapshot"].get("gameId");print("-- Battlelog Data Processed");def X21():print("Finding Server to join");if X4["A1"]["E1"]<30:return"A1";elif X4["A3"]["E1"]<30:return"A3";elif X4["A2"]["E1"]<30:return"A2";else:return"idle";def X22():X23=X21();if X24():X25();print("-- game tried to execute while already running an instance");time.sleep(10);print("joining",f"{X23}");X26=X4[f"{X23}"]["F1"];if os.path.exists('C:\\Program Files\\EA Games\\Battlefield 4'):subprocess.run(['bf4.exe','-webMode','MP','-Origin_NoAppFocus','--activate-webhelper','-requestState','State_ConnectToGameId','-requestStateParams',f'<data password="" putinsquad="true" gameid="{X26}" role="soldier" personaref="{X1}" levelmode="mp"></data>','-Online.BlazeLogLevel','2','-Online.DirtysockLogLevel','2'],shell=True,cwd='F:\\Program Files\\EA Games\\Battlefield 4');else:subprocess.run(['bf4.exe','-webMode','MP','-Origin_NoAppFocus','--activate-webhelper','-requestState','State_ConnectToGameId','-requestStateParams',f'<data password="" putinsquad="true" gameid="{X26}" role="soldier" personaref="{X1}" levelmode="mp"></data>','-Online.BlazeLogLevel','2','-Online.DirtysockLogLevel','2'],shell=True,cwd='F:\\Program Files (x86)\\Origin Games\\Battlefield 4');print("Game Executed");def X24():print("Checking if BF4 is running");global X2;X27={"Host":"127.0.0.1:4219","Origin":"https://battlelog.battlefield.com"};try:X28=requests.get("http://127.0.0.1:4219",headers=X27,timeout=9);if X28.status_code==200:X2=True;print("- Game IS running");return True;except requests.exceptions.Timeout:X2=False;print("- Game is NOT running");return False;except requests.exceptions.RequestException:X2=False;print("- Game is NOT running");return False;def X25():X27={"Host":"127.0.0.1:4219","Origin":"https://battlelog.battlefield.com"};try:X28=requests.get("http://127.0.0.1:4219/killgame",headers=X27,timeout=1);if X28.status_code==200:print("Game Killed");except requests.exceptions.ConnectionError:print("Error killing game");def X29():print("Checking if EA app is running");try:X28=requests.get("http://127.0.0.1:3215/ping",timeout=9);X3=True;print("ea app running?",f"{X3}");except requests.exceptions.Timeout:X3=False;print("ea app running?",f"{X3}");except requests.exceptions.RequestException:X3=False;print("ea app running?",f"{X3}");def X30():try:subprocess.run([r"C:\\Program Files\\Electronic Arts\\EA Desktop\\EA Desktop\\EALauncher.exe"],check=True);print("EA Launcher started successfully.");except subprocess.CalledProcessError as X31:print(f"Error launching EA Launcher: {X31}");except FileNotFoundError:print("EALauncher.exe not found. Please check the path.");except Exception as X31:print(f"An unexpected error occurred: {X31}");def X32():if X1=="":print("Please add your user ID to the script");return;global X8;global X7;X33=0;X24();if X2:X25();time.sleep(10);if X29()==True:print("error exiting game");if X29()==False:X30();print("waiting 15 seconds");time.sleep(15);while True:X15();X20();X8=X7;X34=random.randint(20,100);X7=X21();if X24():if X7=="idle":print("servers are full, exiting game");X25();elif X7!=X8:print(f"{X8}","is full, joining",f"{X7}","instead");X25();print("Randomizing Timing Actions");time.sleep(X34);X22();elif X7==X8:print("Staying put");else:print("- Something went wrong, game is running but nothing works!! -");print(X4);else:if X7=="idle":print("Servers are full, staying put");elif X7!=X8:print(f"{X7}"," needs players, joining now");print("Randomizing Timing Actions");time.sleep(X34);X22();elif X7==X8:print("Server did not change, but game is not running");print("Assume game crashed, attempting rejoin");print("Randomizing Timing Actions");time.sleep(X34);X22();else:print("- Error: Game is not running, no parameters met -");print(X4);time.sleep(100);X32()
